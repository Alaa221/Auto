<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Car Showroom</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body { background:#f8f9fa; font-family:"Cairo",sans-serif; }
    /* ===== Ø§Ù„Ù‡ÙŠØ¯Ø± (Ø£ÙƒØ¨Ø± Ø£ÙÙ‚ÙŠÙ‹Ø§) ===== */
    .header {
      width:100%;
      height:360px; /* ÙƒØ¨Ø±Ù†Ø§ Ø§Ù„Ù‡ÙŠØ¯Ø± */
      background: url("/static/header.jpg") center/cover no-repeat;
      border-bottom-left-radius:18px;
      border-bottom-right-radius:18px;
    }

    /* ===== ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù„ÙŠÙ†ÙƒØ§Øª + Ø§Ù„Ø¨Ø­Ø« ØªØ­Øª Ø§Ù„ØµÙˆØ±Ø© ===== */
    .toolbar {
      width:90%;
      max-width:1200px;
      margin: 18px auto;
      background: #fff;
      padding: 14px 18px;
      border-radius:12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.06);
      display: flex;
      flex-direction: column;
      gap:10px;
      align-items: center;
    }

    /* Ø§Ù„Ù„ÙŠÙ†ÙƒØ§Øª ÙÙŠ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø£ÙˆÙ„ (Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù…Ø±ÙƒØ²) */
    .links-row {
      width:100%;
      text-align:center;
    }
    .links-row a {
      display:inline-block;
      margin: 0 14px;
      color:#333;
      font-weight:700;
      text-decoration:none;
      font-size:18px;
      padding:6px 12px;
      border-radius:8px;
      transition: background .18s, color .18s, transform .12s;
    }
    .links-row a:hover { background:#f1f1f1; transform:translateY(-2px); color:#dc3545; }
    .links-row a.active { background:#dc3545; color:#fff; }

    /* Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ ØµÙ Ù…Ù†ÙØµÙ„ ØªØ­Øª Ø§Ù„Ù„ÙŠÙ†ÙƒØ§Øª (Ù…Ù†Ø³Ù‚ ÙˆØµØºÙŠØ±) */
    .search-row {
      width:100%;
      display:flex;
      justify-content:center;
    }
    .search-row form {
      display:flex;
      gap:6px;
      align-items:center;
    }
    .search-row input[type="text"]{
      width:260px;
      padding:8px 12px;
      border-radius:24px 6px 6px 24px;
      border:1px solid #ddd;
      outline:none;
    }
    .search-row button {
      padding:8px 14px;
      border-radius:6px 24px 24px 6px;
      border: none;
      background:#dc3545;
      color:#fff;
      font-weight:700;
      cursor:pointer;
    }
    .search-row button:hover { background:#a71d2a; }

    /* ===== Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¶Ø§ÙØ© (Ù„Ù… ØªÙ„Ù…Ø³Ù†Ø§Ù‡) ===== */
    .form-section { background:#fff; padding:22px; border-radius:12px; box-shadow:0 6px 20px rgba(0,0,0,0.04); margin:18px auto; max-width:1100px; }

    /* ===== Ø§Ù„ÙƒØ±ÙˆØª Ù…Ø¹ Ø§Ù†ÙŠÙ…ÙŠØ´Ù† Ø¹Ù†Ø¯ Ø§Ù„ÙˆÙ‚ÙˆÙ ===== */
    .cars-grid { display:grid; grid-template-columns: repeat(auto-fill,minmax(280px,1fr)); gap:20px; width:90%; max-width:1200px; margin: 18px auto 60px auto; }
    .car-card { border-radius:12px; overflow:hidden; background:#fff; box-shadow:0 6px 18px rgba(0,0,0,0.06); transition: transform .25s ease, box-shadow .25s ease; }
    .car-card:hover { transform: translateY(-8px); box-shadow:0 14px 36px rgba(0,0,0,0.12); }
    .car-card img { width:100%; height:180px; object-fit:cover; display:block; }
    .car-body { padding:14px; text-align:right; }
    .car-body h5 { margin:0 0 6px 0; font-weight:700; }
    .car-body p { margin:4px 0; color:#555; font-size:14px; }

    /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
    .btn-small { padding:7px 12px; border-radius:10px; font-weight:700; }
    .btn-reserve { background:#28a745; color:#fff; border:none; }
    .btn-cancel { background:#ffc107; color:#111; border:none; }
    .btn-delete { background:#dc3545; color:#fff; border:none; }

    /* Ù„Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙƒØ±ÙˆØª Ø¹Ù†Ø¯ ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± */
    .hidden { display:none !important; }
  </style>
</head>
<body>

  <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
  <div class="header"></div>

  <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù„ÙŠÙ†ÙƒØ§Øª ÙˆØ§Ù„Ø¨Ø­Ø« ØªØ­Øª Ø§Ù„ØµÙˆØ±Ø© -->
  <div class="toolbar" role="region" aria-label="Toolbar">
    <!-- Ø§Ù„Ù„ÙŠÙ†ÙƒØ§Øª Ù…Ø±ÙƒØ²ÙŠÙ† -->
    <div class="links-row" aria-hidden="false">
      <a href="#" id="link-all" class="active" onclick="showAll(); return false;">ÙƒÙ„ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ§Øª</a>
      <a href="#" id="link-reserved" onclick="showReserved(); return false;">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ§Øª Ø§Ù„Ù…Ø­Ø¬ÙˆØ²Ø©</a>
    </div>

    <!-- Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ ØµÙ ØªØ­Øª Ø§Ù„Ù„ÙŠÙ†ÙƒØ§Øª -->
    <div class="search-row" role="search">
      <form action="{{ url_for('index') }}" method="get" novalidate>
        <input type="text" name="search" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø³ÙŠØ§Ø±Ø©..." value="{{ search_query or '' }}">
        <button type="submit">Ø¨Ø­Ø«</button>
      </form>
    </div>
  </div>

  <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¶Ø§ÙØ© (ÙƒÙ…Ø§ ÙƒØ§Ù†) -->
  <div class="form-section">
    <form method="post" enctype="multipart/form-data" action="{{ url_for('index') }}">
      <div class="row g-3">
        <div class="col-md-6">
          <input required name="name" class="form-control" placeholder="Ø§Ø³Ù… Ø§Ù„Ø³ÙŠØ§Ø±Ø©">
        </div>
        <div class="col-md-6">
          <input required name="color" class="form-control" placeholder="Ø§Ù„Ù„ÙˆÙ†">
        </div>
        <div class="col-md-6">
          <input required name="condition" class="form-control" placeholder="Ø§Ù„Ø­Ø§Ù„Ø©">
        </div>
        <div class="col-md-6">
          <input name="image" type="file" class="form-control">
        </div>
        <div class="col-12">
          <textarea name="description" class="form-control" rows="3" placeholder="Ø§Ù„ÙˆØµÙ"></textarea>
        </div>
        <div class="col-12 text-center">
          <button class="btn btn-danger btn-lg px-5" type="submit">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³ÙŠØ§Ø±Ø©</button>
        </div>
      </div>
    </form>
  </div>

  <!-- Ø´Ø¨ÙƒØ© Ø§Ù„ÙƒØ±ÙˆØª -->
  <div class="cars-grid" id="carsGrid">
    {% for car in cars %}
    <!-- Ø£Ø¶ÙÙ†Ø§ data-reserved Ø­ØªÙ‰ Ù†Ø¹Ù…Ù„ ÙÙ„ØªØ± client-side Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± Ø§Ù„Ø¨Ø§Ùƒ-Ø¥Ù†Ø¯ -->
    <div class="car-card" data-reserved="{{ '1' if car.reserved else '0' }}">
      {% if car.image %}
        <img src="{{ car.image }}" alt="{{ car.name }}">
      {% else %}
        <img src="/static/noimage.png" alt="no image">
      {% endif %}
      <div class="car-body">
        <h5>{{ car.name }}</h5>
        <p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> {{ car.condition }}</p>
        <p><strong>Ø§Ù„Ù„ÙˆÙ†:</strong> {{ car.color }}</p>
        <p>{{ car.description }}</p>

        <div class="d-flex justify-content-between mt-2">
          {% if not car.reserved %}
            <a href="{{ url_for('reserve', car_id=car.id) }}" class="btn btn-reserve btn-small">Ø­Ø¬Ø²</a>
          {% else %}
            <a href="{{ url_for('reserve', car_id=car.id) }}" class="btn btn-cancel btn-small">Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø²</a>
          {% endif %}
          <a href="{{ url_for('delete', car_id=car.id) }}" class="btn btn-delete btn-small">Ø­Ø°Ù</a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <script>
    // ÙÙ„ØªØ± Ø¨Ø³ÙŠØ· client-side Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ø¬ÙˆØ²Ø© Ø£Ùˆ ÙƒÙ„ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ§Øª
    const linkAll = document.getElementById('link-all');
    const linkReserved = document.getElementById('link-reserved');

    function showAll() {
      toggleActive(linkAll);
      document.querySelectorAll('#carsGrid .car-card').forEach(card => {
        card.classList.remove('hidden');
      });
    }

    function showReserved() {
      toggleActive(linkReserved);
      document.querySelectorAll('#carsGrid .car-card').forEach(card => {
        const reserved = card.getAttribute('data-reserved');
        if (reserved === '1') card.classList.remove('hidden');
        else card.classList.add('hidden');
      });
    }

    function toggleActive(activeEl) {
      [linkAll, linkReserved].forEach(el => el.classList.remove('active'));
      activeEl.classList.add('active');
    }

    // Ù„Ùˆ Ø§Ù„ØµÙØ­Ø© Ø¬Øª Ù…Ø¹ query param ÙŠØ­Ø§ÙˆÙ„ ÙŠØ·Ø¨Ù‚ ÙÙ„ØªØ± ØªÙ„Ù‚Ø§Ø¦ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
    (function applyQueryFilter(){
      const params = new URLSearchParams(window.location.search);
      if (params.get('filter') === 'reserved') {
        showReserved();
      } else {
        showAll();
      }
    })();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
